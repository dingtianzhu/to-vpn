# ToVPN å‰ç«¯ API æ¥å£æ–‡æ¡£

> ç‰ˆæœ¬: v1.0  
> åŸºç¡€è·¯å¾„: `http://localhost:8080/api/v1`  
> è®¤è¯æ–¹å¼: Bearer Token (JWT)

---

## ç›®å½•

1. [é€šç”¨è¯´æ˜](#ä¸€é€šç”¨è¯´æ˜)
2. [è®¤è¯æ¥å£](#äºŒè®¤è¯æ¥å£)
3. [ç”¨æˆ·æ¥å£](#ä¸‰ç”¨æˆ·æ¥å£)
4. [VPN èŠ‚ç‚¹æ¥å£](#å››vpnèŠ‚ç‚¹æ¥å£)
5. [ä½¿ç”¨ç»Ÿè®¡æ¥å£](#äº”ä½¿ç”¨ç»Ÿè®¡æ¥å£)
6. [å¾…å®ç°æ¥å£](#å…­å¾…å®ç°æ¥å£)

---

## ä¸€ã€é€šç”¨è¯´æ˜

### 1.1 è¯·æ±‚å¤´

| åç§° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| Content-Type | string | æ˜¯ | `application/json` |
| Authorization | string | éƒ¨åˆ†æ¥å£éœ€è¦ | `Bearer <access_token>` |

### 1.2 ç»Ÿä¸€å“åº”æ ¼å¼

```json
{
  "code": 0,
  "message": "success",
  "data": {},
  "timestamp": 1699999999
}
```

### 1.3 é”™è¯¯å“åº”æ ¼å¼

```json
{
  "code": 10001,
  "message": "ç”¨æˆ·ä¸å­˜åœ¨",
  "data": null,
  "timestamp": 1699999999
}
```

### 1.4 HTTP çŠ¶æ€ç 

| çŠ¶æ€ç  | è¯´æ˜ |
|-------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒï¼ˆTokenæ— æ•ˆæˆ–è¿‡æœŸï¼‰ |
| 403 | ç¦æ­¢è®¿é—®ï¼ˆæƒé™ä¸è¶³ï¼‰ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## äºŒã€è®¤è¯æ¥å£

### 2.1 å‘é€éªŒè¯ç  âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /auth/send-code
```


**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| target | string | æ˜¯ | é‚®ç®±æˆ–æ‰‹æœºå· |
| type | int | æ˜¯ | 1æ³¨å†Œ 2ç™»å½• 3é‡ç½®å¯†ç  4ç»‘å®šæ‰‹æœº 5ç»‘å®šé‚®ç®± |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "target": "user@example.com",
  "type": 1
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "éªŒè¯ç å·²å‘é€",
  "data": null,
  "timestamp": 1699999999
}
```

**é”™è¯¯å“åº”**
```json
{
  "code": 10010,
  "message": "éªŒè¯ç å‘é€è¿‡äºé¢‘ç¹",
  "data": null,
  "timestamp": 1699999999
}
```

---

### 2.2 ç”¨æˆ·æ³¨å†Œ âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /auth/register
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| username | string | æ˜¯ | ç”¨æˆ·åï¼Œ3-50ä½å­—æ¯æ•°å­— |
| email | string | æ˜¯ | é‚®ç®± |
| password | string | æ˜¯ | å¯†ç ï¼Œ6-32ä½ |
| code | string | æ˜¯ | éªŒè¯ç ï¼Œ6ä½ |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "username": "testuser",
  "email": "user@example.com",
  "password": "123456",
  "code": "123456"
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": null,
  "timestamp": 1699999999
}
```

**é”™è¯¯å“åº”**
```json
{
  "code": 10002,
  "message": "ç”¨æˆ·å·²å­˜åœ¨",
  "data": null,
  "timestamp": 1699999999
}
```

---

### 2.3 ç”¨æˆ·ç™»å½• âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /auth/login
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| account | string | æ˜¯ | ç”¨æˆ·å/é‚®ç®±/æ‰‹æœºå· |
| password | string | æ˜¯ | å¯†ç  |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "account": "admin",
  "password": "admin123"
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 7200,
    "token_type": "Bearer",
    "user": {
      "id": 1,
      "uuid": "550e8400-e29b-41d4-a716-446655440000",
      "username": "admin",
      "email": "admin@example.com",
      "nickname": "ç³»ç»Ÿç®¡ç†å‘˜",
      "avatar": "",
      "roles": ["super_admin"],
      "expireDate": "2025-12-31T23:59:59Z"
    }
  },
  "timestamp": 1699999999
}
```

**é”™è¯¯å“åº”**
```json
{
  "code": 10004,
  "message": "å¯†ç é”™è¯¯",
  "data": null,
  "timestamp": 1699999999
}
```


---

### 2.4 åˆ·æ–°ä»¤ç‰Œ âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /auth/refresh
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| refresh_token | string | æ˜¯ | åˆ·æ–°ä»¤ç‰Œ |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 7200,
    "token_type": "Bearer"
  },
  "timestamp": 1699999999
}
```

**é”™è¯¯å“åº”**
```json
{
  "code": 20005,
  "message": "åˆ·æ–°ä»¤ç‰Œæ— æ•ˆ",
  "data": null,
  "timestamp": 1699999999
}
```

---

### 2.5 ç”¨æˆ·ç™»å‡º âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /auth/logout
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "ç™»å‡ºæˆåŠŸ",
  "data": null,
  "timestamp": 1699999999
}
```

---

### 2.6 é‡ç½®å¯†ç  âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /auth/reset-password
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| email | string | æ˜¯ | é‚®ç®± |
| code | string | æ˜¯ | éªŒè¯ç ï¼Œ6ä½ |
| new_password | string | æ˜¯ | æ–°å¯†ç ï¼Œ6-32ä½ |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "email": "user@example.com",
  "code": "123456",
  "new_password": "newpassword123"
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "å¯†ç é‡ç½®æˆåŠŸ",
  "data": null,
  "timestamp": 1699999999
}
```

**é”™è¯¯å“åº”**
```json
{
  "code": 10008,
  "message": "éªŒè¯ç é”™è¯¯",
  "data": null,
  "timestamp": 1699999999
}
```

---

## ä¸‰ã€ç”¨æˆ·æ¥å£

### 3.1 è·å–ç”¨æˆ·ä¿¡æ¯ âœ… å·²å®ç°

**è¯·æ±‚**
```
GET /user/profile
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "id": 1,
    "uuid": "550e8400-e29b-41d4-a716-446655440000",
    "username": "admin",
    "email": "admin@example.com",
    "nickname": "ç³»ç»Ÿç®¡ç†å‘˜",
    "avatar": "https://example.com/avatar.jpg",
    "roles": ["user"],
    "expireDate": "2025-12-31T23:59:59Z",
    "createdAt": "2024-01-01T00:00:00Z"
  },
  "timestamp": 1699999999
}
```

---

### 3.2 æ›´æ–°ç”¨æˆ·ä¿¡æ¯ âœ… å·²å®ç°

**è¯·æ±‚**
```
PUT /user/profile
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| nickname | string | å¦ | æ˜µç§° |
| email | string | å¦ | é‚®ç®± |
| avatar | string | å¦ | å¤´åƒURL |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "nickname": "æ–°æ˜µç§°",
  "avatar": "https://example.com/new-avatar.jpg"
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "æ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "username": "admin",
    "nickname": "æ–°æ˜µç§°",
    "avatar": "https://example.com/new-avatar.jpg"
  },
  "timestamp": 1699999999
}
```


---

### 3.3 ä¿®æ”¹å¯†ç  âœ… å·²å®ç°

**è¯·æ±‚**
```
PUT /user/password
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| old_password | string | æ˜¯ | æ—§å¯†ç  |
| new_password | string | æ˜¯ | æ–°å¯†ç ï¼Œ6-32ä½ |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "old_password": "oldpassword123",
  "new_password": "newpassword123"
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "å¯†ç ä¿®æ”¹æˆåŠŸ",
  "data": null,
  "timestamp": 1699999999
}
```

**é”™è¯¯å“åº”**
```json
{
  "code": 10004,
  "message": "æ—§å¯†ç é”™è¯¯",
  "data": null,
  "timestamp": 1699999999
}
```

---

### 3.4 ä¸Šä¼ å¤´åƒ âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /user/avatar
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
Content-Type: multipart/form-data
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| file | File | æ˜¯ | å›¾ç‰‡æ–‡ä»¶ï¼Œæ”¯æŒ jpg/png/gifï¼Œæœ€å¤§ 2MB |

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "ä¸Šä¼ æˆåŠŸ",
  "data": {
    "url": "https://example.com/avatars/user123.jpg"
  },
  "timestamp": 1699999999
}
```

---

## å››ã€VPNèŠ‚ç‚¹æ¥å£

### 4.1 è·å–èŠ‚ç‚¹åˆ—è¡¨ âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /vpn/nodes
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| country | string | å¦ | å›½å®¶ä»£ç ç­›é€‰ï¼Œå¦‚ "US", "JP" |
| status | int | å¦ | çŠ¶æ€ç­›é€‰ï¼š1æ­£å¸¸ 2ç»´æŠ¤ 3ç¦»çº¿ |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "country": "US",
  "status": 1
}
```

**æˆåŠŸå“åº”**

> âš ï¸ **é‡è¦**: å‰ç«¯æœŸæœ›çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼Œæ‰€æœ‰å¿…å¡«å­—æ®µå¿…é¡»è¿”å›æœ‰æ•ˆå€¼ï¼Œä¸èƒ½ä¸º null

```json
{
  "code": 0,
  "message": "success",
  "data": [
    {
      "id": 1,
      "name": "ç¾å›½-æ´›æ‰çŸ¶",
      "country": "US",
      "city": "Los Angeles",
      "flag": "ğŸ‡ºğŸ‡¸",
      "domain": "us-la.example.com",
      "port": 20443,
      "protocol": "hysteria2",
      "password": "server_password",
      "status": 1
    }
  ],
  "timestamp": 1699999999
}
```

**å“åº”å­—æ®µè¯´æ˜ï¼ˆå‰ç«¯æœŸæœ›çš„ ServerNode ç±»å‹ï¼‰**

#### åŸºç¡€å­—æ®µï¼ˆå¿…å¡«ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| id | number | âœ… æ˜¯ | èŠ‚ç‚¹å”¯ä¸€æ ‡è¯†ï¼Œæ•°æ®åº“ä¸»é”® |
| name | string | å¦ | èŠ‚ç‚¹åç§°ï¼Œå¦‚ "ç¾å›½-æ´›æ‰çŸ¶" |
| country | string | âœ… æ˜¯ | å›½å®¶ä»£ç ï¼Œå¦‚ "US", "JP", "HK" |
| city | string | âœ… æ˜¯ | åŸå¸‚åç§°ï¼Œå¦‚ "Los Angeles", "Tokyo" |
| flag | string | âœ… æ˜¯ | å›½æ—— emojiï¼Œå¦‚ "ğŸ‡ºğŸ‡¸", "ğŸ‡¯ğŸ‡µ" |
| domain | string | âœ… æ˜¯ | **æœåŠ¡å™¨åŸŸåæˆ–IPåœ°å€**ï¼Œç”¨äº Hysteria2 è¿æ¥ï¼Œ**ä¸èƒ½ä¸º null æˆ–ç©ºå­—ç¬¦ä¸²** |
| port | number | âœ… æ˜¯ | **æœåŠ¡å™¨ç«¯å£**ï¼ŒèŒƒå›´ 1-65535ï¼Œ**ä¸èƒ½ä¸º null æˆ– 0** |
| protocol | string | å¦ | åè®®ç±»å‹ï¼Œé»˜è®¤ "hysteria2" |
| password | string | âœ… æ˜¯ | **è¿æ¥å¯†ç **ï¼Œç”¨äº Hysteria2 è®¤è¯ |
| status | number | âœ… æ˜¯ | èŠ‚ç‚¹çŠ¶æ€ï¼š1=æ­£å¸¸ 2=ç»´æŠ¤ä¸­ 3=ç¦»çº¿ |

#### æ‰©å±•å­—æ®µï¼ˆå®¢æˆ·ç«¯å±•ç¤ºç”¨ï¼Œå¯é€‰ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| tags | string[] | å¦ | æ ‡ç­¾æ•°ç»„ï¼Œå¦‚ ["æ¨è", "é«˜é€Ÿ", "æ¸¸æˆ"] |
| region | string | å¦ | åœ°åŒºåˆ†ç»„ï¼Œå¦‚ "asia", "europe", "america" |
| tier | number | å¦ | èŠ‚ç‚¹ç­‰çº§ï¼š1=å…è´¹ 2=æ ‡å‡† 3=é«˜çº§ï¼Œç”¨äºæƒé™æ§åˆ¶ |
| sort_order | number | å¦ | æ’åºæƒé‡ï¼Œæ•°å€¼è¶Šå°è¶Šé å‰ |
| multiplier | number | å¦ | æµé‡å€ç‡ï¼Œå¦‚ 1.0=æ­£å¸¸, 0.5=åŠä»·, 2.0=åŒå€ |
| speed_limit | number | å¦ | é™é€Ÿ (Mbps)ï¼Œ0 æˆ– -1 è¡¨ç¤ºä¸é™é€Ÿ |
| created_at | string | å¦ | èŠ‚ç‚¹åˆ›å»ºæ—¶é—´ ISO8601 |
| updated_at | string | å¦ | èŠ‚ç‚¹æ›´æ–°æ—¶é—´ ISO8601 |

**å®Œæ•´å“åº”ç¤ºä¾‹ï¼ˆåŒ…å«æ‰©å±•å­—æ®µï¼‰**

```json
{
  "code": 0,
  "message": "success",
  "data": [
    {
      "id": 1,
      "name": "ç¾å›½-æ´›æ‰çŸ¶ 01",
      "country": "US",
      "city": "Los Angeles",
      "flag": "ğŸ‡ºğŸ‡¸",
      "domain": "us-la-01.example.com",
      "port": 20443,
      "protocol": "hysteria2",
      "password": "server_password",
      "status": 1,
      "tags": ["æ¨è", "é«˜é€Ÿ"],
      "region": "america",
      "tier": 2,
      "sort_order": 1,
      "multiplier": 1.0,
      "speed_limit": 0,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-12-10T10:00:00Z"
    }
  ],
  "timestamp": 1699999999
}
```

**TypeScript ç±»å‹å®šä¹‰**

```typescript
// src/types/server.ts
export interface ServerNode {
  // === åŸºç¡€å­—æ®µï¼ˆå¿…å¡«ï¼‰===
  id: number;           // æ•°æ®åº“ IDï¼ˆå¿…å¡«ï¼‰
  name?: string;        // èŠ‚ç‚¹åç§°ï¼ˆå¯é€‰ï¼‰
  country: string;      // å›½å®¶ä»£ç ï¼ˆå¿…å¡«ï¼‰
  city: string;         // åŸå¸‚åç§°ï¼ˆå¿…å¡«ï¼‰
  flag: string;         // å›½æ—— emojiï¼ˆå¿…å¡«ï¼‰
  domain: string;       // æœåŠ¡å™¨åŸŸå/IPï¼ˆå¿…å¡«ï¼Œä¸èƒ½ä¸ºç©ºï¼‰
  port: number;         // æœåŠ¡å™¨ç«¯å£ï¼ˆå¿…å¡«ï¼Œ1-65535ï¼‰
  protocol?: string;    // åè®®ç±»å‹ï¼ˆå¯é€‰ï¼Œé»˜è®¤ hysteria2ï¼‰
  password: string;     // è¿æ¥å¯†ç ï¼ˆå¿…å¡«ï¼‰
  status: number;       // çŠ¶æ€ç ï¼ˆå¿…å¡«ï¼Œ1/2/3ï¼‰
  ping?: number;        // å»¶è¿Ÿæ¯«ç§’ï¼ˆå¯é€‰ï¼Œå‰ç«¯è®¡ç®—ï¼‰
  
  // === æ‰©å±•å­—æ®µï¼ˆå®¢æˆ·ç«¯å±•ç¤ºç”¨ï¼‰===
  tags?: string[];      // æ ‡ç­¾æ•°ç»„
  region?: string;      // åœ°åŒºåˆ†ç»„
  tier?: number;        // èŠ‚ç‚¹ç­‰çº§ (1/2/3)
  sort_order?: number;  // æ’åºæƒé‡
  multiplier?: number;  // æµé‡å€ç‡
  speed_limit?: number; // é™é€Ÿ (Mbps)
  
  // === æ—¶é—´å­—æ®µ ===
  created_at?: string;  // åˆ›å»ºæ—¶é—´ ISO8601
  updated_at?: string;  // æ›´æ–°æ—¶é—´ ISO8601
}
```

**å­—æ®µç”¨é€”è¯´æ˜**

| åŠŸèƒ½åœºæ™¯ | ä½¿ç”¨å­—æ®µ |
|---------|---------|
| èŠ‚ç‚¹ç­›é€‰ | tags, region, tier, speed_limit |
| æƒé™æ§åˆ¶ | tier (å…è´¹ç”¨æˆ·åªèƒ½ç”¨ tier=1 çš„èŠ‚ç‚¹) |
| æµé‡è®¡è´¹ | multiplier (å€ç‡èŠ‚ç‚¹) |
| æ’åºå±•ç¤º | sort_order |

**å‰ç«¯ä½¿ç”¨ç¤ºä¾‹**

```typescript
// å‰ç«¯è°ƒç”¨ Tauri å‘½ä»¤è¿æ¥ VPN æ—¶éœ€è¦ä»¥ä¸‹å­—æ®µ
await invoke("connect_hysteria", {
  serverId: node.id,           // å¿…é¡»æ˜¯æœ‰æ•ˆæ•°å­—
  domain: node.domain,         // å¿…é¡»æ˜¯éç©ºå­—ç¬¦ä¸²
  port: node.port,             // å¿…é¡»æ˜¯æœ‰æ•ˆç«¯å£å·
  password: node.password,     // å¿…é¡»æ˜¯å­—ç¬¦ä¸²
  mode: "tun",                 // è¿æ¥æ¨¡å¼
  serverMtu: 1400,             // MTU è®¾ç½®
  serverDns: "google",         // DNS è®¾ç½®
});
```

**å¸¸è§é”™è¯¯**

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|------|---------|
| `invalid args 'domain': missing required key domain` | domain å­—æ®µä¸º null æˆ–æœªè¿”å› | ç¡®ä¿åç«¯è¿”å›æœ‰æ•ˆçš„ domain å­—ç¬¦ä¸² |
| `invalid args 'nodes': invalid type: null` | èŠ‚ç‚¹åˆ—è¡¨ä¸º null | ç¡®ä¿è¿”å›ç©ºæ•°ç»„ `[]` è€Œé null |
| `Invalid server: missing domain` | å‰ç«¯éªŒè¯å¤±è´¥ | æ£€æŸ¥åç«¯è¿”å›çš„ domain å­—æ®µ |
| `Invalid server: missing port` | å‰ç«¯éªŒè¯å¤±è´¥ | æ£€æŸ¥åç«¯è¿”å›çš„ port å­—æ®µ |

---

## äº”ã€ä½¿ç”¨ç»Ÿè®¡æ¥å£

### 5.1 è·å–ä½¿ç”¨ç»Ÿè®¡ âœ… å·²å®ç°

**è¯·æ±‚**
```
GET /user/usage?date=2024-01-01
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æŸ¥è¯¢å‚æ•°**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| date | string | å¦ | æ—¥æœŸï¼Œæ ¼å¼ YYYY-MM-DDï¼Œé»˜è®¤ä»Šå¤© |

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "date": "2024-01-01",
    "traffic_used": 1073741824,
    "traffic_limit": 10737418240,
    "time_used": 3600,
    "time_limit": 86400,
    "connections": 5
  },
  "timestamp": 1699999999
}
```

> æ³¨ï¼štraffic å•ä½ä¸ºå­—èŠ‚ï¼Œtime å•ä½ä¸ºç§’


---

### 5.2 è·å–å†å²ä½¿ç”¨ç»Ÿè®¡ âœ… å·²å®ç°

**è¯·æ±‚**
```
GET /user/usage/history?period=week&page=1&page_size=10
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æŸ¥è¯¢å‚æ•°**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| period | string | å¦ | æ—¶é—´èŒƒå›´ï¼štoday/week/monthï¼Œé»˜è®¤ week |
| page | int | å¦ | é¡µç ï¼Œé»˜è®¤ 1 |
| page_size | int | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ 10 |

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "list": [
      {
        "date": "2024-01-01",
        "download": 536870912,
        "upload": 107374182,
        "duration": 3600,
        "connections": 5
      },
      {
        "date": "2024-01-02",
        "download": 268435456,
        "upload": 53687091,
        "duration": 1800,
        "connections": 3
      }
    ],
    "total": 30,
    "page": 1,
    "page_size": 10,
    "summary": {
      "total_download": 10737418240,
      "total_upload": 2147483648,
      "total_duration": 86400,
      "total_connections": 50
    }
  },
  "timestamp": 1699999999
}
```

> æ³¨ï¼šdownload/upload å•ä½ä¸ºå­—èŠ‚ï¼Œduration å•ä½ä¸ºç§’

---

### 5.3 è·å–æµé‡è¶‹åŠ¿æ•°æ® âœ… å·²å®ç°

**è¯·æ±‚**
```
GET /user/usage/trend?period=week&granularity=day
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æŸ¥è¯¢å‚æ•°**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| period | string | å¦ | æ—¶é—´èŒƒå›´ï¼šweek/month/yearï¼Œé»˜è®¤ week |
| granularity | string | å¦ | æ•°æ®ç²’åº¦ï¼šhour/day/weekï¼Œé»˜è®¤ day |

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "labels": ["01-01", "01-02", "01-03", "01-04", "01-05", "01-06", "01-07"],
    "download": [536870912, 268435456, 402653184, 671088640, 134217728, 805306368, 536870912],
    "upload": [107374182, 53687091, 80530636, 134217728, 26843545, 161061273, 107374182],
    "duration": [3600, 1800, 2700, 4500, 900, 5400, 3600]
  },
  "timestamp": 1699999999
}
```

---

### 5.4 ä¸ŠæŠ¥ä½¿ç”¨ç»Ÿè®¡ âœ… å·²å®ç°

**è¯·æ±‚**
```
POST /user/usage/report
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| node_id | int | æ˜¯ | èŠ‚ç‚¹ID |
| traffic_download | int | æ˜¯ | ä¸‹è½½æµé‡ï¼ˆå­—èŠ‚ï¼‰ |
| traffic_upload | int | æ˜¯ | ä¸Šä¼ æµé‡ï¼ˆå­—èŠ‚ï¼‰ |
| duration | int | æ˜¯ | è¿æ¥æ—¶é•¿ï¼ˆç§’ï¼‰ |
| connected_at | string | æ˜¯ | è¿æ¥æ—¶é—´ ISO8601 |
| disconnected_at | string | æ˜¯ | æ–­å¼€æ—¶é—´ ISO8601 |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "node_id": 1,
  "traffic_download": 104857600,
  "traffic_upload": 10485760,
  "duration": 3600,
  "connected_at": "2024-01-01T10:00:00Z",
  "disconnected_at": "2024-01-01T11:00:00Z"
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "daily_traffic_used": 1073741824,
    "daily_time_used": 7200,
    "limit_exceeded": false
  },
  "timestamp": 1699999999
}
```

---

## å…­ã€å¾…å®ç°æ¥å£

ä»¥ä¸‹æ¥å£å‰ç«¯å·²å®šä¹‰ä½†åç«¯å°šæœªå®ç°ï¼š

### 6.0 VPN è¿æ¥éªŒè¯æ¥å£ ğŸ†• å¾…å®ç°

> [!IMPORTANT]
> ä»¥ä¸‹æ¥å£ç”¨äºæœåŠ¡ç«¯ç”¨é‡éªŒè¯ï¼Œæ›¿ä»£å®¢æˆ·ç«¯æœ¬åœ°éªŒè¯ï¼Œé˜²æ­¢ç”¨æˆ·ç»•è¿‡é™åˆ¶ã€‚

#### 6.0.1 è¿æ¥å‰éªŒè¯ ğŸ†•

**è¯·æ±‚**
```
POST /vpn/connect/precheck
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| node_id | int | æ˜¯ | è¦è¿æ¥çš„èŠ‚ç‚¹ ID |
| connection_mode | string | æ˜¯ | è¿æ¥æ¨¡å¼: "tun" æˆ– "socks" |
| client_version | string | æ˜¯ | å®¢æˆ·ç«¯ç‰ˆæœ¬å· |
| device_id | string | å¦ | è®¾å¤‡æ ‡è¯† |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "node_id": 1,
  "connection_mode": "tun",
  "client_version": "1.0.0",
  "device_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

**æˆåŠŸå“åº” - å…è®¸è¿æ¥**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "can_connect": true,
    "daily_traffic_used": 536870912,
    "daily_traffic_limit": 1073741824,
    "daily_time_used": 3600,
    "daily_time_limit": 7200,
    "remaining_traffic": 536870912,
    "remaining_time": 3600,
    "user_tier": "free",
    "node_allowed": true,
    "connect_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_expires_in": 60
  },
  "timestamp": 1699999999
}
```

**æˆåŠŸå“åº” - æ‹’ç»è¿æ¥ï¼ˆç”¨é‡è¶…é™ï¼‰**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "can_connect": false,
    "reject_reason": "Daily traffic limit exceeded",
    "daily_traffic_used": 1073741824,
    "daily_traffic_limit": 1073741824,
    "daily_time_used": 3600,
    "daily_time_limit": 7200,
    "remaining_traffic": 0,
    "remaining_time": 3600,
    "user_tier": "free",
    "node_allowed": true
  },
  "timestamp": 1699999999
}
```

**å“åº”å­—æ®µè¯´æ˜**

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| can_connect | boolean | æ˜¯å¦å…è®¸è¿æ¥ |
| reject_reason | string | æ‹’ç»åŸå› ï¼ˆå¦‚æœä¸å…è®¸ï¼‰ |
| daily_traffic_used | int | å½“æ—¥å·²ç”¨æµé‡ï¼ˆå­—èŠ‚ï¼‰ |
| daily_traffic_limit | int | å½“æ—¥æµé‡é™åˆ¶ï¼ˆå­—èŠ‚ï¼‰ï¼Œ-1 è¡¨ç¤ºæ— é™ |
| daily_time_used | int | å½“æ—¥å·²ç”¨æ—¶é—´ï¼ˆç§’ï¼‰ |
| daily_time_limit | int | å½“æ—¥æ—¶é—´é™åˆ¶ï¼ˆç§’ï¼‰ï¼Œ-1 è¡¨ç¤ºæ— é™ |
| remaining_traffic | int | å‰©ä½™æµé‡ï¼Œ-1 è¡¨ç¤ºæ— é™ |
| remaining_time | int | å‰©ä½™æ—¶é—´ï¼Œ-1 è¡¨ç¤ºæ— é™ |
| user_tier | string | ç”¨æˆ·ç­‰çº§: "free"/"vip"/"admin" |
| node_allowed | boolean | æ˜¯å¦æœ‰æƒè®¿é—®æ­¤èŠ‚ç‚¹ |
| node_reject_reason | string | èŠ‚ç‚¹æ‹’ç»åŸå›  |
| connect_token | string | è¿æ¥ä»¤ç‰Œï¼ˆç”¨äºé˜²é‡æ”¾ï¼‰ |
| token_expires_in | int | ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆç§’ï¼‰ |

---

#### 6.0.2 è·å–å®æ—¶ç”¨é‡ ğŸ†•

**è¯·æ±‚**
```
GET /user/usage/realtime
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "daily_traffic_used": 966367641,
    "daily_traffic_limit": 1073741824,
    "daily_time_used": 6480,
    "daily_time_limit": 7200,
    "should_disconnect": false,
    "warning": "You have used 90% of your daily traffic limit"
  },
  "timestamp": 1699999999
}
```

**å“åº”å­—æ®µè¯´æ˜**

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| daily_traffic_used | int | å½“æ—¥å·²ç”¨æµé‡ï¼ˆå­—èŠ‚ï¼‰ |
| daily_traffic_limit | int | å½“æ—¥æµé‡é™åˆ¶ï¼ˆå­—èŠ‚ï¼‰ |
| daily_time_used | int | å½“æ—¥å·²ç”¨æ—¶é—´ï¼ˆç§’ï¼‰ |
| daily_time_limit | int | å½“æ—¥æ—¶é—´é™åˆ¶ï¼ˆç§’ï¼‰ |
| should_disconnect | boolean | æ˜¯å¦åº”è¯¥æ–­å¼€è¿æ¥ |
| disconnect_reason | string | æ–­å¼€åŸå›  |
| warning | string | æ¥è¿‘é™åˆ¶æ—¶çš„è­¦å‘Šæ¶ˆæ¯ |

---

### 6.1 è®¢é˜…/å¥—é¤æ¥å£ âœ… å·²å®ç°

#### 6.1.1 è·å–å¥—é¤åˆ—è¡¨

**è¯·æ±‚**
```
GET /plans
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": [
    {
      "id": 1,
      "name": "å…è´¹å¥—é¤",
      "price": 0,
      "duration": 30,
      "traffic_limit": 1073741824,
      "time_limit": 3600,
      "features": ["åŸºç¡€èŠ‚ç‚¹", "é™é€Ÿ10Mbps"],
      "recommended": false
    },
    {
      "id": 2,
      "name": "æœˆåº¦ä¼šå‘˜",
      "price": 29.9,
      "duration": 30,
      "traffic_limit": 107374182400,
      "time_limit": -1,
      "features": ["å…¨éƒ¨èŠ‚ç‚¹", "ä¸é™é€Ÿ", "ä¼˜å…ˆæ”¯æŒ"],
      "recommended": true
    }
  ],
  "timestamp": 1699999999
}
```

#### 6.1.2 è·å–å½“å‰è®¢é˜…

**è¯·æ±‚**
```
GET /user/subscription
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "plan_id": 2,
    "plan_name": "æœˆåº¦ä¼šå‘˜",
    "start_date": "2024-01-01T00:00:00Z",
    "expire_date": "2024-01-31T23:59:59Z",
    "auto_renew": true,
    "status": 1
  },
  "timestamp": 1699999999
}
```

---

### 6.2 æ”¯ä»˜æ¥å£ âœ… å·²å®ç°

#### 6.2.1 åˆ›å»ºè®¢å•

**è¯·æ±‚**
```
POST /orders
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚ä½“**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|-----|------|
| plan_id | int | æ˜¯ | å¥—é¤ID |
| payment_method | string | æ˜¯ | æ”¯ä»˜æ–¹å¼ï¼šalipay/wechat |
| coupon_code | string | å¦ | ä¼˜æƒ åˆ¸ç  |

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "plan_id": 2,
  "payment_method": "alipay",
  "coupon_code": "DISCOUNT10"
}
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "order_id": "ORD202401010001",
    "amount": 26.91,
    "original_amount": 29.9,
    "discount": 2.99,
    "payment_url": "https://pay.example.com/...",
    "expire_time": "2024-01-01T10:30:00Z"
  },
  "timestamp": 1699999999
}
```

#### 6.2.2 æŸ¥è¯¢è®¢å•çŠ¶æ€

**è¯·æ±‚**
```
GET /orders/{order_id}
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "order_id": "ORD202401010001",
    "status": 1,
    "status_text": "å·²æ”¯ä»˜",
    "amount": 26.91,
    "paid_at": "2024-01-01T10:05:00Z"
  },
  "timestamp": 1699999999
}
```

> è®¢å•çŠ¶æ€ï¼š0å¾…æ”¯ä»˜ 1å·²æ”¯ä»˜ 2å·²å–æ¶ˆ 3å·²è¿‡æœŸ 4å·²é€€æ¬¾


---

### 6.3 å…¬å‘Š/é€šçŸ¥æ¥å£ âœ… å·²å®ç°

#### 6.3.1 è·å–å…¬å‘Šåˆ—è¡¨

**è¯·æ±‚**
```
GET /announcements?page=1&page_size=10
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "title": "ç³»ç»Ÿç»´æŠ¤é€šçŸ¥",
        "content": "ç³»ç»Ÿå°†äº...",
        "type": "notice",
        "priority": 1,
        "created_at": "2024-01-01T00:00:00Z"
      }
    ],
    "total": 10,
    "page": 1,
    "page_size": 10
  },
  "timestamp": 1699999999
}
```

---

### 6.4 è®¾å¤‡ç®¡ç†æ¥å£ âœ… å·²å®ç°

#### 6.4.1 è·å–è®¾å¤‡åˆ—è¡¨

**è¯·æ±‚**
```
GET /user/devices
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": [
    {
      "id": 1,
      "device_id": "device_uuid_123",
      "device_name": "MacBook Pro",
      "device_type": "desktop",
      "os": "macOS 14.0",
      "last_active": "2024-01-01T10:00:00Z",
      "is_current": true
    }
  ],
  "timestamp": 1699999999
}
```

#### 6.4.2 ç§»é™¤è®¾å¤‡

**è¯·æ±‚**
```
DELETE /user/devices/{device_id}
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "è®¾å¤‡å·²ç§»é™¤",
  "data": null,
  "timestamp": 1699999999
}
```

---

### 6.5 é‚€è¯·/æ¨èæ¥å£ âœ… å·²å®ç°

#### 6.5.1 è·å–é‚€è¯·ç 

**è¯·æ±‚**
```
GET /user/invite-code
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "invite_code": "ABC123",
    "invite_url": "https://tovpn.com/register?code=ABC123",
    "total_invited": 5,
    "total_reward": 50.0
  },
  "timestamp": 1699999999
}
```

#### 6.5.2 è·å–é‚€è¯·è®°å½•

**è¯·æ±‚**
```
GET /user/invites?page=1&page_size=10
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "invited_user": "user***@example.com",
        "reward": 10.0,
        "status": 1,
        "created_at": "2024-01-01T00:00:00Z"
      }
    ],
    "total": 5,
    "page": 1,
    "page_size": 10
  },
  "timestamp": 1699999999
}
```

---

## ä¸ƒã€é”™è¯¯ç è¯´æ˜

### 7.1 é€šç”¨é”™è¯¯ç  (1-999)

| é”™è¯¯ç  | è¯´æ˜ |
|-------|------|
| 0 | æ“ä½œæˆåŠŸ |
| 1 | æœªçŸ¥é”™è¯¯ |
| 2 | å‚æ•°æ— æ•ˆ |
| 3 | èµ„æºä¸å­˜åœ¨ |
| 4 | æ•°æ®åº“é”™è¯¯ |
| 5 | Redisé”™è¯¯ |

### 7.2 ç”¨æˆ·ç›¸å…³é”™è¯¯ç  (10001-19999)

| é”™è¯¯ç  | è¯´æ˜ |
|-------|------|
| 10001 | ç”¨æˆ·ä¸å­˜åœ¨ |
| 10002 | ç”¨æˆ·å·²å­˜åœ¨ |
| 10003 | ç”¨æˆ·å·²è¢«ç¦ç”¨ |
| 10004 | å¯†ç é”™è¯¯ |
| 10005 | å¯†ç æ ¼å¼ä¸æ­£ç¡® |
| 10006 | é‚®ç®±å·²è¢«ä½¿ç”¨ |
| 10007 | æ‰‹æœºå·å·²è¢«ä½¿ç”¨ |
| 10008 | éªŒè¯ç é”™è¯¯ |
| 10009 | éªŒè¯ç å·²è¿‡æœŸ |
| 10010 | éªŒè¯ç å‘é€è¿‡äºé¢‘ç¹ |
| 10011 | ä»Šæ—¥éªŒè¯ç å‘é€æ¬¡æ•°å·²è¾¾ä¸Šé™ |

### 7.3 è®¤è¯ç›¸å…³é”™è¯¯ç  (20001-29999)

| é”™è¯¯ç  | è¯´æ˜ |
|-------|------|
| 20001 | æœªæˆæƒï¼Œè¯·å…ˆç™»å½• |
| 20002 | ä»¤ç‰Œæ— æ•ˆ |
| 20003 | ä»¤ç‰Œå·²è¿‡æœŸ |
| 20004 | ä»¤ç‰Œç”Ÿæˆå¤±è´¥ |
| 20005 | åˆ·æ–°ä»¤ç‰Œæ— æ•ˆ |
| 20006 | æƒé™ä¸è¶³ |

### 7.4 è®¢å•æ”¯ä»˜ç›¸å…³é”™è¯¯ç  (30001-39999)

| é”™è¯¯ç  | è¯´æ˜ |
|-------|------|
| 30001 | è®¢å•ä¸å­˜åœ¨ |
| 30002 | è®¢å•å·²æ”¯ä»˜ |
| 30003 | è®¢å•å·²å–æ¶ˆ |
| 30004 | è®¢å•å·²è¿‡æœŸ |
| 30005 | æ”¯ä»˜å¤±è´¥ |
| 30006 | é€€æ¬¾å¤±è´¥ |

### 7.5 æˆæƒç›¸å…³é”™è¯¯ç  (40001-49999)

| é”™è¯¯ç  | è¯´æ˜ |
|-------|------|
| 40001 | æˆæƒä¸å­˜åœ¨ |
| 40002 | æˆæƒæ— æ•ˆ |
| 40003 | æˆæƒå·²è¿‡æœŸ |
| 40004 | æˆæƒå·²ç¦ç”¨ |
| 40005 | è®¾å¤‡æ•°é‡å·²è¾¾ä¸Šé™ |
| 40006 | è®¾å¤‡ä¸å­˜åœ¨ |

---

## å…«ã€æ¥å£å®ç°çŠ¶æ€æ±‡æ€»

| æ¨¡å— | æ¥å£ | çŠ¶æ€ |
|-----|------|------|
| è®¤è¯ | å‘é€éªŒè¯ç  | âœ… å·²å®ç° |
| è®¤è¯ | ç”¨æˆ·æ³¨å†Œ | âœ… å·²å®ç° |
| è®¤è¯ | ç”¨æˆ·ç™»å½• | âœ… å·²å®ç° |
| è®¤è¯ | åˆ·æ–°ä»¤ç‰Œ | âœ… å·²å®ç° |
| è®¤è¯ | ç”¨æˆ·ç™»å‡º | âœ… å·²å®ç° |
| è®¤è¯ | é‡ç½®å¯†ç  | âœ… å·²å®ç° |
| ç”¨æˆ· | è·å–ç”¨æˆ·ä¿¡æ¯ | âœ… å·²å®ç° |
| ç”¨æˆ· | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | âœ… å·²å®ç° |
| ç”¨æˆ· | ä¿®æ”¹å¯†ç  | âœ… å·²å®ç° |
| ç”¨æˆ· | ä¸Šä¼ å¤´åƒ | âœ… å·²å®ç° |
| VPN | è·å–èŠ‚ç‚¹åˆ—è¡¨ | âœ… å·²å®ç° |
| ç»Ÿè®¡ | è·å–ä½¿ç”¨ç»Ÿè®¡ | âœ… å·²å®ç° |
| ç»Ÿè®¡ | è·å–å†å²ä½¿ç”¨ç»Ÿè®¡ | âœ… å·²å®ç° |
| ç»Ÿè®¡ | è·å–æµé‡è¶‹åŠ¿æ•°æ® | âœ… å·²å®ç° |
| ç»Ÿè®¡ | ä¸ŠæŠ¥ä½¿ç”¨ç»Ÿè®¡ | âœ… å·²å®ç° |
| è®¢é˜… | è·å–å¥—é¤åˆ—è¡¨ | âœ… å·²å®ç° |
| è®¢é˜… | è·å–å½“å‰è®¢é˜… | âœ… å·²å®ç° |
| æ”¯ä»˜ | åˆ›å»ºè®¢å• | âœ… å·²å®ç° |
| æ”¯ä»˜ | æŸ¥è¯¢è®¢å•çŠ¶æ€ | âœ… å·²å®ç° |
| å…¬å‘Š | è·å–å…¬å‘Šåˆ—è¡¨ | âœ… å·²å®ç° |
| è®¾å¤‡ | è·å–è®¾å¤‡åˆ—è¡¨ | âœ… å·²å®ç° |
| è®¾å¤‡ | ç§»é™¤è®¾å¤‡ | âœ… å·²å®ç° |
| é‚€è¯· | è·å–é‚€è¯·ç  | âœ… å·²å®ç° |
| é‚€è¯· | è·å–é‚€è¯·è®°å½• | âœ… å·²å®ç° |


---

## ä¹ã€å‰ç«¯è”è°ƒçŠ¶æ€

> æ›´æ–°æ—¥æœŸ: 2024-12-10  
> è”è°ƒæµ‹è¯•: 34 ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡

### 9.1 å‰ç«¯å·²è”è°ƒæ¥å£

| æ¨¡å— | æ¥å£ | å‰ç«¯è°ƒç”¨ä½ç½® | è”è°ƒçŠ¶æ€ |
|-----|------|-------------|---------|
| è®¤è¯ | å‘é€éªŒè¯ç  | RegisterView, ForgotPasswordView | âœ… å·²è”è°ƒ |
| è®¤è¯ | ç”¨æˆ·æ³¨å†Œ | RegisterView | âœ… å·²è”è°ƒ |
| è®¤è¯ | ç”¨æˆ·ç™»å½• | auth.ts store | âœ… å·²è”è°ƒ |
| è®¤è¯ | åˆ·æ–°ä»¤ç‰Œ | request.ts | âœ… å·²è”è°ƒ |
| è®¤è¯ | ç”¨æˆ·ç™»å‡º | auth.ts store | âœ… å·²è”è°ƒ |
| è®¤è¯ | é‡ç½®å¯†ç  | ForgotPasswordView | âœ… å·²è”è°ƒ |
| ç”¨æˆ· | è·å–ç”¨æˆ·ä¿¡æ¯ | ProfileView | âœ… å·²è”è°ƒ |
| ç”¨æˆ· | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | ProfileView | âœ… å·²è”è°ƒ |
| ç”¨æˆ· | ä¿®æ”¹å¯†ç  | (å¾…æ·»åŠ UI) | âš ï¸ APIå°±ç»ª |
| ç”¨æˆ· | ä¸Šä¼ å¤´åƒ | ProfileView | âœ… å·²è”è°ƒ |
| VPN | è·å–èŠ‚ç‚¹åˆ—è¡¨ | servers.ts store | âœ… å·²è”è°ƒ |
| ç»Ÿè®¡ | è·å–ä½¿ç”¨ç»Ÿè®¡ | ProfileView, stats.ts | âœ… å·²è”è°ƒ |
| ç»Ÿè®¡ | ä¸ŠæŠ¥ä½¿ç”¨ç»Ÿè®¡ | vpn.ts store | âœ… å·²è”è°ƒ |
| ç»Ÿè®¡ | è·å–å†å²ä½¿ç”¨ç»Ÿè®¡ | stats.ts, StatsView | âœ… å·²è”è°ƒ |
| ç»Ÿè®¡ | è·å–æµé‡è¶‹åŠ¿æ•°æ® | stats.ts, StatsView | âœ… å·²è”è°ƒ |
| è®¢é˜… | è·å–å½“å‰è®¢é˜… | ProfileView | âœ… å·²è”è°ƒ |
| è®¢é˜… | è·å–å¥—é¤åˆ—è¡¨ | plan.ts | âœ… å·²è”è°ƒ |
| æ”¯ä»˜ | åˆ›å»ºè®¢å• | plan.ts | âœ… å·²è”è°ƒ |
| æ”¯ä»˜ | æŸ¥è¯¢è®¢å•çŠ¶æ€ | plan.ts | âœ… å·²è”è°ƒ |
| å…¬å‘Š | è·å–å…¬å‘Šåˆ—è¡¨ | announce.ts | âœ… å·²è”è°ƒ |
| è®¾å¤‡ | è·å–è®¾å¤‡åˆ—è¡¨ | device.ts | âœ… å·²è”è°ƒ |
| è®¾å¤‡ | ç§»é™¤è®¾å¤‡ | device.ts | âœ… å·²è”è°ƒ |
| é‚€è¯· | è·å–é‚€è¯·ç  | invite.ts | âœ… å·²è”è°ƒ |
| é‚€è¯· | è·å–é‚€è¯·è®°å½• | invite.ts | âœ… å·²è”è°ƒ |

### 9.2 è”è°ƒæµ‹è¯•è¦†ç›–

```
æµ‹è¯•æ–‡ä»¶: src/__tests__/api/api-integration.test.ts
æµ‹è¯•ç”¨ä¾‹: 44 ä¸ª âœ… å…¨éƒ¨é€šè¿‡
è¦†ç›–èŒƒå›´:
  - è®¤è¯æ¥å£å‚æ•°æ ¼å¼éªŒè¯ (6 ä¸ª)
  - ç”¨æˆ·æ¥å£å‚æ•°æ ¼å¼éªŒè¯ (5 ä¸ª)
  - VPN èŠ‚ç‚¹æ¥å£éªŒè¯ (4 ä¸ª)
  - ç»Ÿè®¡æ¥å£éªŒè¯ (4 ä¸ª) âœ¨ æ–°å¢
  - è®¢é˜…æ¥å£éªŒè¯ (4 ä¸ª) âœ¨ æ–°å¢
  - ç»Ÿä¸€å“åº”æ ¼å¼éªŒè¯ (2 ä¸ª)
  - é”™è¯¯ç èŒƒå›´éªŒè¯ (4 ä¸ª)
  - API æ¨¡å—å¯¼å‡ºéªŒè¯ (5 ä¸ª)
```

### 9.3 å‰ç«¯ API æ¨¡å—ç»“æ„

```
src/api/
â”œâ”€â”€ index.ts      # ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ auth.ts       # è®¤è¯ç›¸å…³ (7ä¸ªå‡½æ•°) âœ…
â”œâ”€â”€ user.ts       # ç”¨æˆ·ç›¸å…³ (5ä¸ªå‡½æ•°) âœ…
â”œâ”€â”€ server.ts     # VPNèŠ‚ç‚¹ (1ä¸ªå‡½æ•°) âœ…
â”œâ”€â”€ stats.ts      # ç»Ÿè®¡ç›¸å…³ (2ä¸ªå‡½æ•°) âœ…
â”œâ”€â”€ plan.ts       # å¥—é¤è®¢é˜… (4ä¸ªå‡½æ•°) âœ…
â”œâ”€â”€ device.ts     # è®¾å¤‡ç®¡ç† (2ä¸ªå‡½æ•°) âœ…
â”œâ”€â”€ announce.ts   # å…¬å‘Š (1ä¸ªå‡½æ•°) âœ…
â””â”€â”€ invite.ts     # é‚€è¯· (2ä¸ªå‡½æ•°) âœ…
```

### 9.4 è”è°ƒå®ŒæˆçŠ¶æ€

| çŠ¶æ€ | æ•°é‡ | è¯´æ˜ |
|-----|------|------|
| âœ… å·²è”è°ƒ | 23 | å‰ç«¯è°ƒç”¨ + åç«¯å®ç° + æµ‹è¯•é€šè¿‡ |
| âš ï¸ APIå°±ç»ª | 1 | ä¿®æ”¹å¯†ç ï¼ˆå¾…æ·»åŠ UIå…¥å£ï¼‰ |
| æ€»è®¡ | 24 | æ‰€æœ‰æ¥å£å‡å·²å®Œæˆè”è°ƒ |
