import { defineStore } from "pinia";
import { ref, computed } from "vue";

type Locale = "en" | "zh";

const translations = {
  en: {
    common: {
      connect: "Connect",
      disconnect: "Disconnect",
      stop: "Stop",
      connecting: "Connecting",
      cancel: "Cancel",
      loading: "Loading...",
      save: "Save",
      recover: "Recover Network",
      betaWarning: "Beta Version - Database Direct Mode",
      securityTip:
        "Caution: Direct database connection is used for demonstration. Do not use in production.",
    },
    status: {
      disconnected: "Not Connected",
      connecting: "Connecting...",
      connected: "Secure Connection",
      disconnecting: "Disconnecting...",
      error: "Connection Error",
    },
    nav: {
      home: "Home",
      servers: "Servers",
      logs: "Logs",
      settings: "Settings",
    },
    stats: {
      download: "Download",
      upload: "Upload",
      latency: "Latency",
      ip: "IP Address",
      loading: "Loading...",
      hidden: "Hidden",
    },
    servers: {
      title: "Locations",
      searchPlaceholder: "Search location...",
      selectedLocation: "Selected Location",
      ping: "Ping",
      load: "Load",
      empty: "No servers found",
      refresh: "Refresh Latency",
    },
    logs: {
      title: "Console",
      clear: "Clear",
      empty: "No logs available",
      waiting: "Waiting for input...",
      filter: {
        all: "All Messages",
        info: "Info",
        warn: "Warnings",
        error: "Errors",
      },
    },
    settings: {
      title: "Settings",
      general: "General",
      language: "Language",
      appearance: "Appearance",
      theme: {
        label: "Theme",
        light: "Light",
        dark: "Dark",
        system: "System",
      },
      connection: "Connection",
      connectionMode: "Connection Mode",
      socksMode: "SOCKS Mode",
      tunMode: "TUN Mode",
      proxyOnly: "Proxy Only (1080)",
      globalRoute: "Global Route",
      networkPreferences: "Network Preferences",
      autoReconnect: "Auto Reconnect",
      dns: "DNS Provider",
      customDns: "Custom DNS...",
      customDnsPlaceholder: "e.g. 1.1.1.1",
      customDnsHint: "Press Enter or click outside to apply",
      mtu: "MTU Size",
      serverConfig: "Server Configuration",
      domain: "Server Domain",
      password: "Password",
      adminMode: "Admin Mode: Full Access",
      userMode: "Managed Mode",
      helper: {
        title: "System Extension",
        installed: "Active",
        missing: "Missing",
        install: "Install Helper",
        uninstall: "Uninstall",
        desc: "Required for VPN permission management.",
      },
    },
    login: {
      title: "Login",
      username: "Username",
      password: "Password",
      submit: "Sign In",
      subtitle: "Default Admin: admin / admin",
      forgotPassword: "Forgot Password",
      register: "Register",
      loginToProfile: "Login to view your profile",
      enterUsername: "Enter username",
      enterPassword: "Enter password",
      pleaseEnterCredentials: "Please enter username and password",
      loginSuccess: "Login successful",
      loginFailed: "Login Failed",
    },
    profile: {
      title: "Account",
      editProfile: "Edit Profile",
      membership: "Membership",
      plan: "Plan",
      expires: "Expires",
      status: "Status",
      unlimited: "Unlimited",
      daysRemaining: "Days Remaining",
      days: "days",
      todayUsage: "Today's Usage",
      freePlanLimit: "Free plan: 1GB/day, 2 hours/day.",
      upgradeToPro: "Upgrade to Pro",
      accountDetails: "Account Details",
      username: "Username",
      userId: "User ID",
      memberSince: "Member Since",
      roles: "Roles",
      cannotChange: "Cannot change",
      copy: "Copy",
      dangerZone: "Danger Zone",
      signOut: "Sign Out",
      cancel: "Cancel",
      saveChanges: "Save Changes",
      saving: "Saving...",
      profileUpdated: "Profile updated successfully",
      updateFailed: "Failed to update profile",
      avatarUpdated: "Avatar updated",
      avatarUploadFailed: "Failed to upload avatar",
      onlyImages: "Only image files are allowed",
      maxSize: "Maximum size is 2MB",
      unknown: "Unknown",
      nickname: "Nickname",
      email: "Email",
    },
    home: {
      systemExtensionRequired: "System Extension required. Go to Settings?",
      limitExceeded: "Usage limit exceeded",
      upgradePrompt: "Upgrade to Pro?",
      selectingNewServer: "Selecting a new server will reconnect automatically",
      loginToConnect: "Login to connect",
      installExtension: "Install System Extension",
      daily: "Daily",
      upgrade: "Upgrade",
      as: "as",
    },
    errors: {
      sessionExpired: "Session expired",
      networkError: "Network error",
      serverError: "Server error",
      unknownError: "Unknown error",
      loadFailed: "Failed to load data",
      invalidUsername: "Username must be 3-50 characters",
      invalidPassword: "Password must be at least 6 characters",
      invalidEmail: "Invalid email format",
      invalidDns: "Invalid IP address format (e.g. 1.1.1.1)",
    },
    tray: {
      upload: "Upload",
      download: "Download",
      connect: "Connect",
      disconnect: "Disconnect",
      connecting: "Connecting...",
      disconnecting: "Disconnecting...",
      home: "Home",
      exit: "Exit",
    },
    register: {
      title: "Create Account",
      username: "Username (3-50 chars)",
      email: "Email",
      password: "Password (min 6 chars)",
      confirmPassword: "Confirm Password",
      code: "Verification Code",
      sendCode: "Send",
      submit: "Sign Up",
      hasAccount: "Already have an account?",
      login: "Log In",
      codeSent: "Verification code sent",
      success: "Registration successful",
      passwordMismatch: "Passwords do not match",
    },
    forgot: {
      title: "Reset Password",
      subtitle: "Enter your email to receive reset code",
      step2: "Enter the code and set new password",
      email: "Email",
      code: "Verification Code",
      newPassword: "New Password (min 6 chars)",
      confirmPassword: "Confirm Password",
      sendCode: "Send Code",
      resend: "Resend",
      submit: "Reset Password",
      backToLogin: "Back to Login",
      codeSent: "Verification code sent to your email",
      success: "Password reset successful",
      passwordMismatch: "Passwords do not match",
    },
  },
  zh: {
    common: {
      connect: "连接",
      disconnect: "断开",
      stop: "停止",
      connecting: "连接中",
      cancel: "取消",
      loading: "加载中...",
      save: "保存",
      recover: "修复网络",
      betaWarning: "Beta 版本 - 数据库直连模式",
      securityTip: "注意：当前使用数据库直连仅供演示，请勿在生产环境使用。",
    },
    status: {
      disconnected: "未连接",
      connecting: "正在连接...",
      connected: "安全连接",
      disconnecting: "正在断开...",
      error: "连接错误",
    },
    nav: {
      home: "首页",
      servers: "服务器",
      logs: "日志",
      settings: "设置",
    },
    stats: {
      download: "下载",
      upload: "上传",
      latency: "延迟",
      ip: "IP 地址",
      loading: "加载中...",
      hidden: "已隐藏",
    },
    servers: {
      title: "服务器列表",
      searchPlaceholder: "搜索地区...",
      selectedLocation: "当前选择",
      ping: "延迟",
      load: "负载",
      empty: "未找到服务器",
      refresh: "刷新延迟",
    },
    logs: {
      title: "控制台",
      clear: "清除",
      empty: "暂无日志",
      waiting: "等待输入...",
      filter: {
        all: "所有消息",
        info: "信息",
        warn: "警告",
        error: "错误",
      },
    },
    settings: {
      title: "偏好设置",
      general: "通用",
      language: "语言",
      appearance: "外观",
      theme: {
        label: "主题",
        light: "浅色",
        dark: "深色",
        system: "跟随系统",
      },
      connection: "连接",
      connectionMode: "连接模式",
      socksMode: "SOCKS 模式",
      tunMode: "TUN 模式",
      proxyOnly: "仅代理 (1080)",
      globalRoute: "全局路由",
      networkPreferences: "网络偏好",
      autoReconnect: "自动重连",
      dns: "DNS 服务商",
      customDns: "自定义 DNS...",
      customDnsPlaceholder: "例如 1.1.1.1",
      customDnsHint: "按回车或点击外部应用",
      mtu: "MTU 大小",
      serverConfig: "服务器配置",
      domain: "服务器域名",
      password: "连接密码",
      adminMode: "管理员模式：完全访问权限",
      userMode: "托管模式",
      helper: {
        title: "系统助手",
        installed: "运行中",
        missing: "未安装",
        install: "安装助手",
        uninstall: "卸载助手",
        desc: "用于管理 VPN 连接权限。",
      },
    },
    login: {
      title: "登录",
      username: "用户名",
      password: "密码",
      submit: "登录",
      subtitle: "默认管理员: admin / admin",
      forgotPassword: "忘记密码",
      register: "去注册",
      loginToProfile: "登录以查看个人资料",
      enterUsername: "请输入用户名",
      enterPassword: "请输入密码",
      pleaseEnterCredentials: "请输入用户名和密码",
      loginSuccess: "登录成功",
      loginFailed: "登录失败",
    },
    profile: {
      title: "账户",
      editProfile: "编辑资料",
      membership: "会员信息",
      plan: "套餐",
      expires: "到期时间",
      status: "状态",
      unlimited: "无限制",
      daysRemaining: "剩余天数",
      days: "天",
      todayUsage: "今日用量",
      freePlanLimit: "免费版：每日 1GB 流量，2 小时时长",
      upgradeToPro: "升级到专业版",
      accountDetails: "账户详情",
      username: "用户名",
      userId: "用户 ID",
      memberSince: "注册时间",
      roles: "角色",
      cannotChange: "不可修改",
      copy: "复制",
      dangerZone: "危险操作",
      signOut: "退出登录",
      cancel: "取消",
      saveChanges: "保存更改",
      saving: "保存中...",
      profileUpdated: "资料更新成功",
      updateFailed: "更新资料失败",
      avatarUpdated: "头像已更新",
      avatarUploadFailed: "头像上传失败",
      onlyImages: "仅支持图片文件",
      maxSize: "最大 2MB",
      unknown: "未知",
      nickname: "昵称",
      email: "邮箱",
    },
    home: {
      systemExtensionRequired: "需要系统扩展，是否前往设置？",
      limitExceeded: "已达使用限制",
      upgradePrompt: "是否升级到专业版？",
      selectingNewServer: "选择新服务器将自动重新连接",
      loginToConnect: "登录以连接",
      installExtension: "安装系统扩展",
      daily: "每日",
      upgrade: "升级",
      as: "身份",
    },
    errors: {
      sessionExpired: "会话已过期",
      networkError: "网络错误",
      serverError: "服务器错误",
      unknownError: "未知错误",
      loadFailed: "加载数据失败",
      invalidUsername: "用户名需要 3-50 个字符",
      invalidPassword: "密码至少需要 6 个字符",
      invalidEmail: "邮箱格式不正确",
      invalidDns: "IP 地址格式不正确 (例如 1.1.1.1)",
    },
    tray: {
      upload: "上传",
      download: "下载",
      connect: "连接",
      disconnect: "断开",
      connecting: "连接中...",
      disconnecting: "断开中...",
      home: "主页",
      exit: "退出",
    },
    register: {
      title: "创建账户",
      username: "用户名 (3-50字符)",
      email: "邮箱",
      password: "密码 (至少6位)",
      confirmPassword: "确认密码",
      code: "验证码",
      sendCode: "发送",
      submit: "注册",
      hasAccount: "已有账户？",
      login: "去登录",
      codeSent: "验证码已发送",
      success: "注册成功",
      passwordMismatch: "两次密码不一致",
    },
    forgot: {
      title: "重置密码",
      subtitle: "输入邮箱获取重置验证码",
      step2: "输入验证码并设置新密码",
      email: "邮箱",
      code: "验证码",
      newPassword: "新密码 (至少6位)",
      confirmPassword: "确认密码",
      sendCode: "发送验证码",
      resend: "重新发送",
      submit: "重置密码",
      backToLogin: "返回登录",
      codeSent: "验证码已发送到您的邮箱",
      success: "密码重置成功",
      passwordMismatch: "两次密码不一致",
    },
  },
};

export const useI18nStore = defineStore("i18n", () => {
  const locale = ref<Locale>(
    (localStorage.getItem("tovpn_locale") as Locale) || "en"
  );

  const t = computed(() => translations[locale.value]);

  function setLocale(l: Locale) {
    locale.value = l;
    localStorage.setItem("tovpn_locale", l);
  }

  return {
    locale,
    t,
    setLocale,
  };
});
